<!DOCTYPE html>
<html>
    <head>

        <!-- <link rel="stylesheet" type="text/css" href="/index.css"> -->

        <meta charset="utf-8">

        <title>Chat AS WELL AS Draw</title>

    </head>
    <body>

        <h1>Albus Dumbledore is your father</h1>

        <div>
            <h3>Enter your message here</h3>
            <input type="text" id="chat-message" />
            <input type="button" value="Send" onclick="sendChatMessage()" />
        </div>

        <div id="userNames">
            <!-- Usernames will go here as they show up -->
        </div>

        <div id="userChats">
            <!-- userchats will go here as they show up -->
        </div>

        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.2/socket.io.js"></script>

        <script type="text/javascript">
        // console.log(io);
        var socketio = io.connect("http://127.0.0.1:8080");

        socketio.on("users", (socketUsers)=>{
            console.log(socketUsers);
            var newHTML = "";
            socketUsers.map((currSocket, index)=>{
                newHTML += "<li class=user>" + currSocket.name + "</li>";
            });
            document.getElementById("userNames").innerHTML = newHTML;
        });

        socketio.on("messageToClient",(messageObject)=>{
            document.getElementById("userChats").innerHTML += "<div class='message'>" + messageObject.message + " -- " + messageObject.date + "</div>";
        });

        function sendChatMessage(){
            var messageToSend = document.getElementById("chat-message").value;
            socketio.emit("messageToServer", {
                message: messageToSend,
                name: "A girl still has no name..."
            });
        }

        </script>
    </body>
</html>
